<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Private Pilot Study Guide</title>

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="PPL Study">
    <meta name="theme-color" content="#0f172a">

    <link rel="apple-touch-icon" href="https://via.placeholder.com/192x192/2563eb/ffffff?text=PPL">
    <link rel="icon" type="image/png" sizes="192x192" href="https://via.placeholder.com/192x192/2563eb/ffffff?text=PPL">

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7983667074248581" crossorigin="anonymous"></script>

    <style>
        :root { 
            --primary: #0f172a; 
            --accent: #2563eb; 
            --success: #16a34a; 
            --danger: #dc2626;
            --bg: #f8fafc; 
            --card-bg: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
        }
        
        body { 
            font-family: 'Inter', system-ui, -apple-system, sans-serif; 
            line-height: 1.6; 
            background-color: var(--bg); 
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
        }

        .app-container { width: 100%; max-width: 800px; }

        .header { 
            text-align: center; 
            padding: 40px 20px; 
            background: var(--primary); 
            color: white; 
            border-radius: 16px; 
            margin-bottom: 24px; 
            box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1); 
        }

        .header h1 { margin: 0 0 10px 0; font-size: 2.2em; font-weight: 800; letter-spacing: -0.5px; }
        .header p { margin: 0; color: #94a3b8; font-size: 1.1em; }

        .stats-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--card-bg);
            padding: 15px 25px;
            border-radius: 12px;
            margin-bottom: 24px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            font-weight: 600;
        }

        .score-display { color: var(--accent); font-size: 1.1em; }
        
        .timer-display {
            font-family: monospace;
            font-size: 1.4em;
            background: #e2e8f0;
            padding: 4px 12px;
            border-radius: 8px;
            color: var(--primary);
            transition: all 0.3s;
        }

        .timer-warning {
            background: #fef2f2;
            color: var(--danger);
            animation: pulse 1s infinite;
        }

        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

        .progress-track {
            background: #e2e8f0;
            border-radius: 10px;
            height: 10px;
            width: 120px;
            overflow: hidden;
            margin: 0 15px;
        }

        .progress-fill { background: var(--accent); height: 100%; width: 0%; transition: width 0.4s ease-out; }

        .card { 
            background: var(--card-bg); 
            padding: 40px; 
            border-radius: 16px; 
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); 
            margin-bottom: 24px; 
            transition: all 0.3s ease;
        }

        .question { font-weight: 700; font-size: 1.4em; margin-bottom: 25px; display: block; color: var(--primary); }

        .option-item { 
            margin: 12px 0; 
            padding: 18px 24px; 
            border: 2px solid #e2e8f0; 
            border-radius: 12px; 
            cursor: pointer; 
            transition: all 0.2s; 
            font-weight: 500;
            font-size: 1.1em;
            background: #fff;
        }

        .option-item:hover { border-color: var(--accent); background: #eff6ff; transform: translateY(-1px); }
        .option-item.selected { border-color: var(--accent); background: #eff6ff; box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2); }
        .option-item.correct-ans { border-color: var(--success) !important; background: #f0fdf4 !important; color: #166534; pointer-events: none; }
        .option-item.wrong-ans { border-color: var(--danger) !important; background: #fef2f2 !important; color: #991b1b; pointer-events: none; }

        .btn { 
            background: var(--accent); 
            color: white; 
            border: none; 
            padding: 16px 32px; 
            border-radius: 12px; 
            cursor: pointer; 
            font-weight: 700; 
            font-size: 1.1em; 
            width: 100%;
            transition: all 0.2s; 
            margin-top: 10px;
        }

        .btn:hover { background: #1d4ed8; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(37,99,235,0.3); }
        .btn:disabled { background: #94a3b8; cursor: not-allowed; transform: none; box-shadow: none; }
        
        .btn-success { background: var(--success); }
        .btn-success:hover { background: #15803d; box-shadow: 0 4px 12px rgba(22,163,74,0.3); }

        .feedback-box {
            margin-top: 24px;
            padding: 20px;
            border-radius: 12px;
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .feedback-box h4 { margin: 0 0 10px 0; font-size: 1.2em; }
        .feedback-box p { margin: 0 0 10px 0; }
        .ref-tag { display: inline-block; padding: 4px 10px; background: rgba(0,0,0,0.05); border-radius: 6px; font-size: 0.85em; font-weight: 700; color: var(--text-muted); }

        .review-list { list-style: none; padding: 0; }
        .review-list li { background: #fffbeb; border-left: 4px solid #f59e0b; padding: 15px; margin-bottom: 10px; border-radius: 0 8px 8px 0; }

        /* Custom link hover effect */
        a:hover { color: #1d4ed8; text-decoration: underline !important; }

        @media print {
            body { background: white; padding: 0; color: black; }
            .header, #quiz-ui, .btn, .no-print { display: none !important; }
            .app-container { max-width: 100%; }
            .card { box-shadow: none; padding: 0; margin: 0; border: none; }
            .review-list li { background: white; border-left: 2px solid black; border-bottom: 1px solid #ccc; page-break-inside: avoid; }
            #end-title::after { content: " - Private Pilot Study Guide"; }
        }
    </style>
</head>
<body>

    <div class="app-container">
        <div class="header">
            <h1>Private Pilot Study Guide</h1>
            <p>Comprehensive Exam & Print Mode</p>
        </div>

        <div id="quiz-ui">
            <div class="stats-bar">
                <span id="q-counter">Q 1/X</span>
                <div class="progress-track"><div class="progress-fill" id="p-bar"></div></div>
                <div class="timer-display" id="timer-display">60:00</div>
                <span class="score-display">Score: <span id="score-val">0</span></span>
            </div>

            <div class="card" id="q-card">
                <span class="question" id="q-text">Loading...</span>
                <div id="options-container"></div>
                
                <div id="feedback" class="feedback-box">
                    <h4 id="fb-title"></h4>
                    <p id="fb-text"></p>
                    <span class="ref-tag" id="fb-ref"></span>
                </div>
            </div>

            <button id="action-btn" class="btn" onclick="handleAction()" disabled>Select an Answer</button>
        </div>

        <div id="results-ui" class="card" style="display: none; text-align: center;">
            <h2 id="end-title" style="font-size: 2.5em; margin-bottom: 10px; color: var(--primary);">Exam Complete</h2>
            <p style="font-size: 1.2em; color: var(--text-muted);">Your Final Score: <strong id="final-score" style="color: var(--accent);"></strong></p>
            
            <div id="missed-questions" style="text-align: left; margin-top: 30px;">
                <h3 style="border-bottom: 2px solid #e2e8f0; padding-bottom: 10px;">Study Guide (Items to Review)</h3>
                <ul class="review-list" id="review-ul"></ul>
            </div>
            
            <div style="display: flex; gap: 15px; margin-top: 30px;" class="no-print">
                <button class="btn" onclick="location.reload()">Start New Session</button>
                <button class="btn btn-success" onclick="window.print()" id="print-btn" style="display: none;">üñ®Ô∏è Print Study Guide</button>
            </div>
        </div>

        <div class="card no-print" style="margin-top: 30px; border-top: 4px solid var(--accent); text-align: center;">
            <h3 style="margin-top: 0; color: var(--primary);">Recommended Pilot Gear & Resources</h3>
            <p style="font-size: 0.9em; color: var(--text-muted); margin-bottom: 20px;">Gear up for your flight review or checkride with these essentials.</p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                <a href="https://amzn.to/3ZDvP69" target="_blank" style="text-decoration: none; padding: 15px; border: 1px solid #e2e8f0; border-radius: 8px; color: var(--primary); font-weight: bold; transition: 0.2s;">
                    üìö 2026 FAR/AIM Book
                </a>
                <a href="https://amzn.to/4aBFJdj" target="_blank" style="text-decoration: none; padding: 15px; border: 1px solid #e2e8f0; border-radius: 8px; color: var(--primary); font-weight: bold; transition: 0.2s;">
                    üéß Lightspeed Aviation Headsets
                </a>
                <a href="https://amzn.to/4qL4Gcq" target="_blank" style="text-decoration: none; padding: 15px; border: 1px solid #e2e8f0; border-radius: 8px; color: var(--primary); font-weight: bold; transition: 0.2s;">
                    üì± iPad Pilot Kneeboards
                </a>
            </div>
            <p style="font-size: 0.75em; color: #94a3b8; margin-top: 20px;">*As an affiliate, we may earn a small commission from qualifying purchases at no extra cost to you.</p>
        </div>

        <div class="no-print" style="text-align: center; margin-top: 40px; padding-bottom: 20px;">
            <p style="color: var(--text-muted); font-size: 0.9em;">
                Brought to you by <a href="https://yankeealphasoftware.com" target="_blank" style="color: var(--accent); text-decoration: none; font-weight: 700; transition: color 0.2s;">Yankee Alpha Software</a>
            </p>
        </div>

    </div>

    <script>
        let quizData = [
            {
                q: "To act as Pilot in Command, what specific items must you have in your physical possession or readily accessible in the aircraft?",
                options: ["Pilot Certificate, Medical Certificate, Logbook", "Pilot Certificate, Medical Certificate (or BasicMed), Government-issued Photo ID", "Pilot Certificate, Government-issued Photo ID, Flight Review Endorsement"],
                answer: "Pilot Certificate, Medical Certificate (or BasicMed), Government-issued Photo ID",
                explanation: "You must hold your pilot certificate, a valid medical (or BasicMed), and a photo ID.",
                ref: "14 CFR 61.3"
            },
            {
                q: "What is the minimum fuel reserve required by the FAA for a VFR day flight?",
                options: ["Enough to fly to the destination, plus 20 minutes at normal cruise speed", "Enough to fly to the destination, plus 30 minutes at normal cruise speed", "Enough to fly to the destination, plus 45 minutes at normal cruise speed"],
                answer: "Enough to fly to the destination, plus 30 minutes at normal cruise speed",
                explanation: "Day VFR requires reaching the first point of intended landing, plus 30 minutes at normal cruising speed.",
                ref: "14 CFR 91.151"
            },
            {
                q: "What is the minimum fuel reserve required for a VFR night flight?",
                options: ["30 minutes", "45 minutes", "60 minutes"],
                answer: "45 minutes",
                explanation: "Night VFR requires enough fuel to fly to the destination plus 45 minutes at normal cruise speed.",
                ref: "14 CFR 91.151"
            },
            {
                q: "Which aircraft has the right-of-way over all other engine-driven aircraft?",
                options: ["An airplane on final approach", "An airship", "A glider"],
                answer: "A glider",
                explanation: "A glider has the right-of-way over an airship, airplane, or rotorcraft due to its lack of an engine.",
                ref: "14 CFR 91.113"
            },
            {
                q: "Unless otherwise authorized, what is the maximum indicated airspeed permitted below 10,000 feet MSL?",
                options: ["200 knots", "250 knots", "288 knots"],
                answer: "250 knots",
                explanation: "The general speed limit below 10,000' MSL is 250 knots.",
                ref: "14 CFR 91.117"
            },
            {
                q: "Unless otherwise authorized, what is the maximum indicated airspeed within Class B airspace?",
                options: ["200 knots", "250 knots", "No speed limit inside Class B"],
                answer: "250 knots",
                explanation: "Inside Class B airspace, the limit is 250 knots. Underneath a Class B shelf, the limit drops to 200 knots.",
                ref: "14 CFR 91.117"
            },
            {
                q: "You are flying a magnetic heading of 180¬∞ at a VFR cruising altitude above 3,000' AGL. Which altitude is legal?",
                options: ["4,500 feet MSL", "5,500 feet MSL", "6,000 feet MSL"],
                answer: "4,500 feet MSL",
                explanation: "For headings 180¬∞-359¬∞ (Westbound), the rule is Even Thousands + 500 feet.",
                ref: "14 CFR 91.159"
            },
            {
                q: "Under VFR in Class E airspace below 10,000 feet MSL, what are the standard minimum visibility and cloud clearance requirements?",
                options: ["1 SM visibility; Clear of clouds", "3 SM visibility; 500' below, 1,000' above, 2,000' horizontal", "5 SM visibility; 1,000' below, 1,000' above, 1 SM horizontal"],
                answer: "3 SM visibility; 500' below, 1,000' above, 2,000' horizontal",
                explanation: "This is the standard '3-152' rule for controlled airspace below 10,000' MSL.",
                ref: "14 CFR 91.155"
            },
            {
                q: "How frequently must an aircraft's transponder be tested and inspected to operate in controlled airspace?",
                options: ["Every 12 calendar months", "Every 24 calendar months", "During every Annual inspection"],
                answer: "Every 24 calendar months",
                explanation: "ATC transponders must be tested and inspected within the preceding 24 calendar months.",
                ref: "14 CFR 91.413"
            },
            {
                q: "To carry passengers, what is the recency of experience requirement for a private pilot?",
                options: ["3 takeoffs and landings in the preceding 90 days in the same category, class, and type of aircraft", "A flight review in the preceding 24 calendar months", "3 takeoffs and landings to a full stop within the preceding 60 days"],
                answer: "3 takeoffs and landings in the preceding 90 days in the same category, class, and type of aircraft",
                explanation: "You must have made 3 takeoffs and landings within the preceding 90 days. For tailwheel aircraft or night operations, they must be to a full stop.",
                ref: "14 CFR 61.57"
            },
            {
                q: "For the purpose of carrying passengers at night, when must your 3 required full-stop landings be accomplished?",
                options: ["Between sunset and sunrise", "From 1 hour after sunset to 1 hour before sunrise", "From the end of evening civil twilight to the beginning of morning civil twilight"],
                answer: "From 1 hour after sunset to 1 hour before sunrise",
                explanation: "Night currency for carrying passengers must be logged during the period from 1 hour after sunset to 1 hour before sunrise.",
                ref: "14 CFR 61.57"
            },
            {
                q: "What documents must be on board the aircraft prior to flight? (Hint: ARROW)",
                options: ["Airworthiness Certificate, Registration, Radio License, Operating Limitations, Weight and Balance", "Airworthiness Certificate, Registration, Repair Logs, Operating Handbook, Weight and Balance", "Airworthiness Certificate, Registration, Radio License, Owner's Manual, Weather Briefing"],
                answer: "Airworthiness Certificate, Registration, Radio License, Operating Limitations, Weight and Balance",
                explanation: "ARROW stands for Airworthiness, Registration, Radio Station License (if international), Operating Limitations, and Weight/Balance data.",
                ref: "14 CFR 91.9 / 91.203"
            },
            {
                q: "What is the validity period of a Third-Class Medical Certificate for a pilot under age 40?",
                options: ["24 calendar months", "60 calendar months", "12 calendar months"],
                answer: "60 calendar months",
                explanation: "If under age 40 when examined, a 3rd class medical is valid until the end of the 60th month. If 40 or older, it expires after 24 months.",
                ref: "14 CFR 61.23"
            },
            {
                q: "What is the minimum safe altitude anywhere?",
                options: ["500 feet AGL", "An altitude allowing, if a power unit fails, an emergency landing without undue hazard to persons or property on the surface", "1,000 feet above the highest obstacle"],
                answer: "An altitude allowing, if a power unit fails, an emergency landing without undue hazard to persons or property on the surface",
                explanation: "The blanket rule for 'anywhere' is that you must be able to make an emergency landing without creating an undue hazard on the surface.",
                ref: "14 CFR 91.119"
            },
            {
                q: "Over congested areas, what is the minimum safe altitude?",
                options: ["500 feet above the surface", "1,000 feet above the highest obstacle within a horizontal radius of 2,000 feet", "1,500 feet above the highest obstacle"],
                answer: "1,000 feet above the highest obstacle within a horizontal radius of 2,000 feet",
                explanation: "Over a city, town, or settlement, you must be 1,000 feet above the highest obstacle within 2,000 feet of the aircraft.",
                ref: "14 CFR 91.119"
            },
            {
                q: "If you change your permanent mailing address, how long do you have to notify the FAA Airmen Certification Branch before your certificate privileges are suspended?",
                options: ["14 days", "30 days", "90 days"],
                answer: "30 days",
                explanation: "You may not exercise the privileges of your pilot certificate after 30 days from moving unless you have notified the FAA of your new address.",
                ref: "14 CFR 61.60"
            },
            {
                q: "No person may act as a crewmember of a civil aircraft with a blood alcohol concentration (BAC) of what level or higher?",
                options: ["0.08 percent", "0.04 percent", "0.02 percent"],
                answer: "0.04 percent",
                explanation: "The FAA limit is 0.04% BAC, and you must also have at least 8 hours from bottle to throttle.",
                ref: "14 CFR 91.17"
            },
            {
                q: "What is the 'bottle to throttle' rule for alcohol consumption?",
                options: ["8 hours", "12 hours", "24 hours"],
                answer: "8 hours",
                explanation: "No person may act as a crewmember within 8 hours after the consumption of any alcoholic beverage.",
                ref: "14 CFR 91.17"
            },
            {
                q: "When must flight crewmembers be provided with and use supplemental oxygen?",
                options: ["For flights above 10,000 feet MSL", "For flights above 12,500 feet MSL up to 14,000 feet MSL for more than 30 minutes", "For all flights above 15,000 feet MSL regardless of time"],
                answer: "For flights above 12,500 feet MSL up to 14,000 feet MSL for more than 30 minutes",
                explanation: "Crew must use oxygen if between 12,500' and 14,000' MSL for a duration greater than 30 minutes.",
                ref: "14 CFR 91.211"
            },
            {
                q: "At what altitude must EVERY occupant of the aircraft be provided with supplemental oxygen?",
                options: ["12,500 feet MSL", "14,000 feet MSL", "15,000 feet MSL"],
                answer: "15,000 feet MSL",
                explanation: "Above 15,000 feet MSL, every occupant (passengers included) must be provided with supplemental oxygen.",
                ref: "14 CFR 91.211"
            },
            {
                q: "When are passengers required to have their seatbelts fastened?",
                options: ["At all times during the flight", "During taxi, takeoff, and landing", "Only during turbulence"],
                answer: "During taxi, takeoff, and landing",
                explanation: "Passengers must be briefed and have their seatbelts fastened during surface movement, takeoff, and landing.",
                ref: "14 CFR 91.107"
            },
            {
                q: "If two aircraft are converging at the same altitude (not head-on), which aircraft has the right of way?",
                options: ["The aircraft on the left", "The aircraft on the right", "The faster aircraft"],
                answer: "The aircraft on the right",
                explanation: "When aircraft of the same category are converging, the aircraft to the other's right has the right-of-way.",
                ref: "14 CFR 91.113"
            },
            {
                q: "If two aircraft are approaching head-on, what action should be taken?",
                options: ["Both aircraft should alter course to the left", "Both aircraft should alter course to the right", "The larger aircraft has the right of way"],
                answer: "Both aircraft should alter course to the right",
                explanation: "When approaching head-on, or nearly so, each pilot of each aircraft shall alter course to the right.",
                ref: "14 CFR 91.113"
            },
            {
                q: "What does a steady green light signal from the control tower mean to an aircraft in flight?",
                options: ["Cleared to land", "Return for landing", "Airport unsafe, do not land"],
                answer: "Cleared to land",
                explanation: "A steady green light gun signal to an aircraft in flight means 'Cleared to land'.",
                ref: "14 CFR 91.125"
            },
            {
                q: "What does a flashing red light signal from the control tower mean to an aircraft taxiing on the ground?",
                options: ["Stop", "Taxi clear of the runway in use", "Return to starting point on airport"],
                answer: "Taxi clear of the runway in use",
                explanation: "On the ground, a flashing red signal means taxi clear of the runway in use. A steady red means stop.",
                ref: "14 CFR 91.125"
            },
            {
                q: "When must the battery in an Emergency Locator Transmitter (ELT) be replaced or recharged?",
                options: ["Every 12 calendar months", "After 1 hour of cumulative use or when 50% of its useful life has expired", "During every 100-hour inspection"],
                answer: "After 1 hour of cumulative use or when 50% of its useful life has expired",
                explanation: "ELT batteries must be replaced after 1 cumulative hour of use, or when 50% of their useful life has expired.",
                ref: "14 CFR 91.207"
            },
            {
                q: "Which incident requires immediate notification to the NTSB?",
                options: ["In-flight generator failure", "Flight control system malfunction", "Ground collision causing $5,000 in damage"],
                answer: "Flight control system malfunction",
                explanation: "NTSB 830.5 lists specific incidents requiring immediate notification, including flight control system malfunctions, in-flight fires, and turbine rotor failures.",
                ref: "NTSB 830.5"
            },
            {
                q: "What are the dimensions of typical Class C airspace?",
                options: ["Surface to 4,000 AGL, 5 NM core radius, 10 NM shelf radius", "Surface to 2,500 AGL, 4 NM radius", "Surface to 10,000 MSL, 10 NM core radius"],
                answer: "Surface to 4,000 AGL, 5 NM core radius, 10 NM shelf radius",
                explanation: "Class C generally consists of a 5 NM radius core (surface to 4,000 AGL) and a 10 NM radius shelf area (1,200 to 4,000 AGL).",
                ref: "AIM 3-2-4"
            },
            {
                q: "What equipment is required to enter Class B airspace?",
                options: ["Two-way radio and Mode C/S transponder with ADS-B Out", "Two-way radio only", "No specific equipment if flying VFR"],
                answer: "Two-way radio and Mode C/S transponder with ADS-B Out",
                explanation: "Class B requires a two-way radio, an operable transponder with altitude reporting, and ADS-B Out equipment.",
                ref: "14 CFR 91.225 / 91.131"
            },
            {
                q: "What action is required prior to entering Class B airspace?",
                options: ["Establish two-way radio communications", "Receive an explicit ATC clearance to enter", "Squawk VFR 1200"],
                answer: "Receive an explicit ATC clearance to enter",
                explanation: "Unlike Class C or D (which only require establishing two-way comms), Class B requires an explicit clearance.",
                ref: "14 CFR 91.131"
            },
            {
                q: "During the day in Class G airspace below 1,200 feet AGL, what are the VFR weather minimums?",
                options: ["1 SM visibility and Clear of Clouds", "3 SM visibility and 1,000' above clouds", "5 SM visibility and Clear of Clouds"],
                answer: "1 SM visibility and Clear of Clouds",
                explanation: "Class G during the day below 1,200 AGL requires only 1 statute mile visibility and to remain clear of clouds.",
                ref: "14 CFR 91.155"
            },
            {
                q: "What are the requirements to operate under Special VFR (SVFR) at night?",
                options: ["1 SM visibility, clear of clouds", "The pilot must be instrument rated and the aircraft equipped for IFR", "Special VFR is not permitted at night"],
                answer: "The pilot must be instrument rated and the aircraft equipped for IFR",
                explanation: "To accept a Special VFR clearance between sunset and sunrise, the pilot must hold an instrument rating and the airplane must be IFR equipped.",
                ref: "14 CFR 91.157"
            },
            {
                q: "To avoid wake turbulence when landing behind a large aircraft, the pilot should:",
                options: ["Fly below the large aircraft's flight path and land before its touchdown point", "Fly above the large aircraft's flight path and land beyond its touchdown point", "Land precisely on the large aircraft's touchdown point"],
                answer: "Fly above the large aircraft's flight path and land beyond its touchdown point",
                explanation: "Wake turbulence sinks, so staying above the heavy aircraft's path and landing beyond where it touched down avoids the vortices.",
                ref: "AIM 7-3-6"
            },
            {
                q: "In what conditions is radiation fog most likely to form?",
                options: ["Warm, moist air blowing over a cold surface", "Calm, clear nights with high humidity", "During a cold front passage with high winds"],
                answer: "Calm, clear nights with high humidity",
                explanation: "Radiation fog forms when the ground cools rapidly on clear, calm nights, cooling the surrounding air to its dewpoint.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "In what conditions is advection fog most likely to form?",
                options: ["Calm, clear nights inland", "Warm, moist air moving over a colder surface, typically requiring some wind", "When rain falls through a temperature inversion"],
                answer: "Warm, moist air moving over a colder surface, typically requiring some wind",
                explanation: "Advection fog forms when warm, moist air is pushed over a cold surface. It requires wind to move the air mass.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "What temperature and humidity conditions are most conducive to carburetor icing?",
                options: ["Temperatures below 0¬∞F (-18¬∞C) with low humidity", "Temperatures between 20¬∞F and 70¬∞F (-7¬∞C to 21¬∞C) with high humidity", "Temperatures above 90¬∞F (32¬∞C) with high humidity"],
                answer: "Temperatures between 20¬∞F and 70¬∞F (-7¬∞C to 21¬∞C) with high humidity",
                explanation: "Carb ice can occur at surprisingly warm temperatures (up to 70¬∞F) if humidity is high, due to the temperature drop in the venturi of the carburetor.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "An airplane stall occurs when:",
                options: ["The airspeed drops below the stall speed", "The critical angle of attack is exceeded", "The engine loses power"],
                answer: "The critical angle of attack is exceeded",
                explanation: "A stall is strictly a function of the angle of attack. An airplane can stall at any airspeed or attitude if the critical angle of attack is exceeded.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "What is a spin?",
                options: ["An aggravated stall resulting in autorotation about the vertical axis", "A rapid descent in a spiral dive", "A maneuver used to lose altitude quickly without gaining airspeed"],
                answer: "An aggravated stall resulting in autorotation about the vertical axis",
                explanation: "A spin is an aggravated stall where one wing is more stalled than the other, causing a yawing motion that results in autorotation.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "What is the load factor in a level, 60-degree banked turn?",
                options: ["1.5 Gs", "2.0 Gs", "3.0 Gs"],
                answer: "2.0 Gs",
                explanation: "In a 60-degree level turn, the load factor doubles, meaning you feel twice your normal weight, and stall speed increases significantly.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "Floating caused by ground effect is most pronounced when the aircraft is:",
                options: ["Less than one wingspan above the surface", "Higher than one wingspan above the surface", "At a high angle of attack at high altitudes"],
                answer: "Less than one wingspan above the surface",
                explanation: "Ground effect restricts the downward deflection of the airstream, decreasing induced drag. It is most noticeable within one wingspan's distance from the ground.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "Which instrument operates on the principle of gyroscopic precession?",
                options: ["Airspeed indicator", "Turn coordinator", "Vertical speed indicator (VSI)"],
                answer: "Turn coordinator",
                explanation: "The turn coordinator uses a canted gyro that responds to yaw and roll through gyroscopic precession. The airspeed and VSI are pitot-static instruments.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "What instruments rely on the pitot-static system?",
                options: ["Altimeter, Airspeed Indicator, Vertical Speed Indicator", "Attitude Indicator, Turn Coordinator, Heading Indicator", "Tachometer, Oil Pressure, Manifold Pressure"],
                answer: "Altimeter, Airspeed Indicator, Vertical Speed Indicator",
                explanation: "The Altimeter, VSI, and Airspeed Indicator all require static pressure. The Airspeed Indicator also requires ram air from the pitot tube.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "If the pitot tube becomes blocked but the static port remains clear, which instrument will be affected?",
                options: ["Altimeter", "Airspeed Indicator", "Vertical Speed Indicator"],
                answer: "Airspeed Indicator",
                explanation: "The airspeed indicator is the only instrument that relies on pitot (ram air) pressure. If blocked, it will act like an altimeter as the aircraft climbs/descends.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "When accelerating on an East or West heading, what magnetic compass error occurs?",
                options: ["The compass will indicate a turn toward the North", "The compass will indicate a turn toward the South", "The compass will lag behind the actual turn"],
                answer: "The compass will indicate a turn toward the North",
                explanation: "The acronym is ANDS: Accelerate North, Decelerate South. This applies when on East or West headings.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "When turning from a Northerly heading, what magnetic compass error occurs?",
                options: ["The compass will lead the turn", "The compass will lag behind the turn and initially indicate a turn in the opposite direction", "No error occurs"],
                answer: "The compass will lag behind the turn and initially indicate a turn in the opposite direction",
                explanation: "The acronym is UNOS: Undershoot North, Overshoot South. When turning from North, the compass lags and initially shows a turn in the wrong direction.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "What is standard temperature and pressure at sea level?",
                options: ["15¬∞C and 29.92\" Hg", "20¬∞C and 30.00\" Hg", "0¬∞C and 29.92\" Hg"],
                answer: "15¬∞C and 29.92\" Hg",
                explanation: "Standard atmospheric conditions at sea level are 15 degrees Celsius (59 Fahrenheit) and 29.92 inches of mercury.",
                ref: "FAA-H-8083-25"
            },
            {
                q: "What does the 'A' in the PAVE personal minimums checklist stand for?",
                options: ["Airspace", "Aircraft", "Attitude"],
                answer: "Aircraft",
                explanation: "PAVE stands for Pilot, Aircraft, enVironment, and External Pressures.",
                ref: "FAA Risk Management Handbook"
            },
            {
                q: "How often are METARs normally issued?",
                options: ["Every 12 hours", "Every 6 hours", "Hourly"],
                answer: "Hourly",
                explanation: "METARs are routine surface observations typically issued on an hourly basis, usually between 50 minutes past the hour and the top of the hour.",
                ref: "AIM 7-1-30"
            },
            {
                q: "What is the standard valid area for a TAF (Terminal Aerodrome Forecast)?",
                options: ["A 5 statute mile radius from the center of an airport runway complex", "A 10 nautical mile radius from the airport center", "The entire airspace sector covered by an ARTCC"],
                answer: "A 5 statute mile radius from the center of an airport runway complex",
                explanation: "A TAF provides a forecast of expected weather conditions within a 5 SM radius of the center of an airport's runway complex.",
                ref: "AIM 7-1-30"
            },
            {
                q: "What is engine detonation?",
                options: ["The spontaneous, explosive ignition of the fuel/air mixture inside the cylinders", "The ignition of the fuel/air mixture prior to the spark plug firing", "The gradual accumulation of carbon deposits on the spark plugs"],
                answer: "The spontaneous, explosive ignition of the fuel/air mixture inside the cylinders",
                explanation: "Detonation is an explosive, uncontrolled ignition of fuel, often caused by using a lower fuel grade than required or excessively high engine temperatures.",
                ref: "FAA-H-8083-25"
            }
        ];

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        let currentQ = 0;
        let score = 0;
        let selectedAnswer = null;
        let isAnswered = false;
        let missedQuestions = [];
        
        let timeRemaining = 3600; 
        let timerInterval;

        const elements = {
            qCounter: document.getElementById('q-counter'),
            pBar: document.getElementById('p-bar'),
            scoreVal: document.getElementById('score-val'),
            timerDisplay: document.getElementById('timer-display'),
            qText: document.getElementById('q-text'),
            optionsContainer: document.getElementById('options-container'),
            actionBtn: document.getElementById('action-btn'),
            feedback: document.getElementById('feedback'),
            fbTitle: document.getElementById('fb-title'),
            fbText: document.getElementById('fb-text'),
            fbRef: document.getElementById('fb-ref'),
            quizUI: document.getElementById('quiz-ui'),
            resultsUI: document.getElementById('results-ui'),
            endTitle: document.getElementById('end-title'),
            finalScore: document.getElementById('final-score'),
            reviewUl: document.getElementById('review-ul'),
            missedDiv: document.getElementById('missed-questions'),
            printBtn: document.getElementById('print-btn')
        };

        function startTimer() {
            timerInterval = setInterval(() => {
                timeRemaining--;
                let minutes = Math.floor(timeRemaining / 60);
                let seconds = timeRemaining % 60;
                
                elements.timerDisplay.innerText = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

                if (timeRemaining <= 300) {
                    elements.timerDisplay.classList.add('timer-warning');
                }

                if (timeRemaining <= 0) {
                    clearInterval(timerInterval);
                    elements.timerDisplay.innerText = "0:00";
                    forceEndExam();
                }
            }, 1000);
        }

        function forceEndExam() {
            elements.endTitle.innerText = "Time's Up!";
            elements.endTitle.style.color = "var(--danger)";
            
            for(let i = currentQ; i < quizData.length; i++) {
                missedQuestions.push(quizData[i]);
            }
            showResults();
        }

        function updateProgress() {
            elements.qCounter.innerText = `Q ${currentQ + 1}/${quizData.length}`;
            elements.pBar.style.width = `${((currentQ) / quizData.length) * 100}%`;
            elements.scoreVal.innerText = score;
        }

        function loadQuestion() {
            isAnswered = false;
            selectedAnswer = null;
            const q = quizData[currentQ];
            
            updateProgress();
            elements.qText.innerText = q.q;
            elements.feedback.style.display = 'none';
            elements.actionBtn.innerText = "Check Answer";
            elements.actionBtn.disabled = true;
            elements.optionsContainer.innerHTML = '';

            let shuffledOptions = [...q.options];
            shuffleArray(shuffledOptions);

            shuffledOptions.forEach((opt) => {
                const div = document.createElement('div');
                div.className = 'option-item';
                div.innerText = opt;
                div.onclick = () => selectOption(opt, div);
                elements.optionsContainer.appendChild(div);
            });

            if (currentQ === 0 && !timerInterval) {
                startTimer();
            }
        }

        function selectOption(optText, element) {
            if (isAnswered) return; 
            
            selectedAnswer = optText;
            Array.from(elements.optionsContainer.children).forEach(child => child.classList.remove('selected'));
            element.classList.add('selected');
            
            elements.actionBtn.disabled = false;
            elements.actionBtn.innerText = "Submit Answer";
        }

        function handleAction() {
            if (!isAnswered) {
                checkAnswer();
            } else {
                nextQuestion();
            }
        }

        function checkAnswer() {
            isAnswered = true;
            const q = quizData[currentQ];
            const options = elements.optionsContainer.children;
            
            elements.feedback.style.display = 'block';
            elements.fbRef.innerText = `Reference: ${q.ref}`;

            Array.from(options).forEach(optDiv => {
                if (optDiv.innerText === q.answer) {
                    optDiv.classList.add('correct-ans');
                } else if (optDiv.innerText === selectedAnswer && selectedAnswer !== q.answer) {
                    optDiv.classList.add('wrong-ans');
                }
            });

            if (selectedAnswer === q.answer) {
                score++;
                elements.scoreVal.innerText = score;
                elements.feedback.style.backgroundColor = '#f0fdf4';
                elements.fbTitle.innerText = "Correct!";
                elements.fbTitle.style.color = 'var(--success)';
            } else {
                elements.feedback.style.backgroundColor = '#fef2f2';
                elements.fbTitle.innerText = "Incorrect";
                elements.fbTitle.style.color = 'var(--danger)';
                missedQuestions.push(q);
            }

            elements.fbText.innerText = q.explanation;
            elements.actionBtn.innerText = currentQ === quizData.length - 1 ? "View Results" : "Next Question ‚Üí";
        }

        function nextQuestion() {
            currentQ++;
            if (currentQ < quizData.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            clearInterval(timerInterval);
            elements.quizUI.style.display = 'none';
            elements.resultsUI.style.display = 'block';
            
            const percentage = Math.round((score / quizData.length) * 100);
            elements.finalScore.innerText = `${score} / ${quizData.length} (${percentage}%)`;

            if (missedQuestions.length === 0) {
                elements.missedDiv.innerHTML = "<h3 style='color: var(--success);'>Flawless!</h3><p>You have an excellent grasp of VFR regulations.</p>";
            } else {
                elements.printBtn.style.display = 'block'; 
                missedQuestions.forEach(q => {
                    const li = document.createElement('li');
                    li.innerHTML = `<strong>Review:</strong> ${q.ref}<br><em>${q.explanation}</em>`;
                    elements.reviewUl.appendChild(li);
                });
            }
        }

        shuffleArray(quizData);
        loadQuestion();
    </script>
</body>
</html>
